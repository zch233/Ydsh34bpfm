"use strict";(self["webpackChunkvue2_cli5"]=self["webpackChunkvue2_cli5"]||[]).push([[930],{49930:function(e,t,r){r.r(t),r.d(t,{default:function(){return a}});var l=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("img",{staticStyle:{width:"200px"},attrs:{src:"https://user-images.githubusercontent.com/499550/93624428-53932780-f9ae-11ea-8d16-af949e16a09f.png"}}),r("h3",[e._v("新的特性")]),r("ol",[r("li",[r("p",[e._v("Composition API（组合 API）")]),r("ul",[r("li",[e._v("setup 配置")]),r("li",[e._v("ref 与 reactive")]),r("li",[e._v("watch 与 watchEffect")]),r("li",[e._v("provide 与 inject")]),r("li",[e._v("......")])])]),r("li",[r("p",[e._v("新的内置组件")]),r("ul",[r("li",[e._v("Fragment")]),r("li",[e._v("Teleport")]),r("li",[e._v("Suspense")])])]),r("li",[r("p",[e._v("其他改变")]),r("ul",[r("li",[e._v("新的生命周期钩子")]),r("li",[e._v("data 选项应始终被声明为一个函数")]),r("li",[e._v("移除 keyCode 支持作为 v-on 的修饰符")]),r("li",[e._v("......")])])])]),r("h1",[e._v("一、常用 Composition API")]),r("p",[e._v("官方文档: https://v3.cn.vuejs.org/guide/composition-api-introduction.html")]),r("h2",[e._v("1.拉开序幕的 setup")]),r("ol",[r("li",[e._v("注意点： "),r("ol",[r("li",[e._v("尽量不要与 Vue2.x 配置混用 "),r("ul",[r("li",[e._v("Vue2.x 配置（data、methos、computed...）中"),r("strong",{staticStyle:{color:"#DD5145"}},[e._v("可以访问到")]),e._v("setup 中的属性、方法。")]),r("li",[e._v("但在 setup 中"),r("strong",{staticStyle:{color:"#DD5145"}},[e._v("不能访问到")]),e._v("Vue2.x 配置（data、methos、computed...）。")]),r("li",[e._v("如果有重名, setup 优先。")])])]),r("li",[e._v("setup 不能是一个 async 函数，因为返回值不再是 return 的对象, 而是 promise, 模板看不到 return 对象中的属性。（后期也可以返回一个 Promise 实例，但需要 Suspense 和异步组件的配合）")])])])]),r("h2",[e._v("2.ref 函数")]),r("ul",[r("li",[e._v("备注： "),r("ul",[r("li",[e._v("接收的数据可以是：基本类型、也可以是对象类型。")]),r("li",[e._v("基本类型的数据：响应式依然是靠"),r("code",{pre:!0},[e._v("Object.defineProperty()")]),e._v("的"),r("code",{pre:!0},[e._v("get")]),e._v("与"),r("code",{pre:!0},[e._v("set")]),e._v("完成的。")]),r("li",[e._v("对象类型的数据：内部 "),r("i",{staticStyle:{color:"gray","font-weight":"bold"}},[e._v("“ 求助 ”")]),e._v(" 了 Vue3.0 中的一个新函数—— "),r("code",{pre:!0},[e._v("reactive")]),e._v("函数。")])])])]),r("h3",[e._v("2.watch 函数")]),r("ul",[r("li",[r("p",[e._v("两个小“坑”：")]),r("ul",[r("li",[e._v("监视 reactive 定义的响应式数据时："),r("strong",[e._v("oldValue 无法正确获取、且强制开启了深度监视（deep 配置失效）")]),e._v("。")]),r("li",[e._v("监视 reactive 定义的响应式数据中"),r("strong",[e._v("某个属性时：deep 配置有效。")])])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* 情况三：监视reactive定义的响应式数据\n\t\t\t若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！\n\t\t\t若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 \n*/")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[e._v("watch")]),e._v("(\n    person,\n    "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("newValue, oldValue")]),e._v(") =>")]),e._v(" {\n        "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[e._v("console")]),e._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[e._v("log")]),e._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'person变化了'")]),e._v(", newValue, oldValue)\n    },\n    { "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("immediate")]),e._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(", "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("deep")]),e._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(" }\n) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//此处的deep配置不再奏效")]),e._v("\n")])])])]),r("h3",[e._v("生命周期")]),r("ul",[r("li",[e._v("Vue3.0 中可以继续使用 Vue2.x 中的生命周期钩子，但有有两个被更名： "),r("ul",[r("li",[r("code",{pre:!0},[e._v("beforeDestroy")]),e._v("改名为 "),r("code",{pre:!0},[e._v("beforeUnmount")])]),r("li",[r("code",{pre:!0},[e._v("destroyed")]),e._v("改名为 "),r("code",{pre:!0},[e._v("unmounted")])])])]),r("li",[e._v("Vue3.0 也提供了 Composition API 形式的生命周期钩子，与 Vue2.x 中钩子对应关系如下： "),r("ul",[r("li",[r("code",{pre:!0},[e._v("beforeCreate")]),e._v("===>"),r("code",{pre:!0},[e._v("setup()")])]),r("li",[r("code",{pre:!0},[e._v("created")]),e._v("=======>"),r("code",{pre:!0},[e._v("setup()")])]),r("li",[r("code",{pre:!0},[e._v("beforeMount")]),e._v(" ===>"),r("code",{pre:!0},[e._v("onBeforeMount")])]),r("li",[r("code",{pre:!0},[e._v("mounted")]),e._v("=======>"),r("code",{pre:!0},[e._v("onMounted")])]),r("li",[r("code",{pre:!0},[e._v("beforeUpdate")]),e._v("===>"),r("code",{pre:!0},[e._v("onBeforeUpdate")])]),r("li",[r("code",{pre:!0},[e._v("updated")]),e._v(" =======>"),r("code",{pre:!0},[e._v("onUpdated")])]),r("li",[r("code",{pre:!0},[e._v("beforeUnmount")]),e._v(" ==>"),r("code",{pre:!0},[e._v("onBeforeUnmount")])]),r("li",[r("code",{pre:!0},[e._v("unmounted")]),e._v(" =====>"),r("code",{pre:!0},[e._v("onUnmounted")])])])])]),r("h2",[e._v("10.toRef")]),r("p",[e._v("注意：当下面再往 perosn 里再加属性，toRefs 是解析不到的，解决方案：直接 return{ person} 使用新增的属性通过使用 person.新增属性 去使用；")]),r("h1",[e._v("二、其它 Composition API")]),r("h2",[e._v("1.shallowReactive 与 shallowRef")]),r("ul",[r("li",[r("p",[e._v("shallowReactive：只处理对象最外层属性的响应式（浅响应式）。")])]),r("li",[r("p",[e._v("shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理。")])]),r("li",[r("p",[e._v("什么时候使用?")]),r("ul",[r("li",[e._v("如果有一个对象数据，结构比较深, 但变化时只是外层属性变化 ===> shallowReactive。")]),r("li",[e._v("如果有一个对象数据，后续功能不会修改该对象中的属性，而是生新的对象来替换 ===> shallowRef。")])])])]),r("h2",[e._v("4.customRef")]),r("ul",[r("li",[r("p",[e._v("作用：创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。")])]),r("li",[r("p",[e._v("实现防抖效果：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v("<template>\n    <input type=\"text\" v-model=\"keyword\" />\n    <h3>{{ keyword }}</h3>\n</template>\n\n<script>\nimport { ref, customRef } from 'vue'\nexport default {\n    name: 'Demo',\n    setup() {\n        // let keyword = ref('hello') //使用Vue准备好的内置ref\n        //自定义一个myRef\n        function myRef(value, delay) {\n            let timer\n            //通过customRef去实现自定义\n            return customRef((track, trigger) => {\n                return {\n                    get() {\n                        track() //告诉Vue这个value值是需要被“追踪”的\n                        return value\n                    },\n                    set(newValue) {\n                        clearTimeout(timer)\n                        timer = setTimeout(() => {\n                            value = newValue\n                            trigger() //告诉Vue去更新界面\n                        }, delay)\n                    },\n                }\n            })\n        }\n        let keyword = myRef('hello', 500) //使用程序员自定义的ref\n        return {\n            keyword,\n        }\n    },\n}\n<\/script>\n")])])])]),r("h2",[e._v("6.响应式数据的判断")]),r("ul",[r("li",[e._v("isRef: 检查一个值是否为一个 ref 对象")]),r("li",[e._v("isReactive: 检查一个对象是否是由 "),r("code",{pre:!0},[e._v("reactive")]),e._v(" 创建的响应式代理")]),r("li",[e._v("isReadonly: 检查一个对象是否是由 "),r("code",{pre:!0},[e._v("readonly")]),e._v(" 创建的只读代理")]),r("li",[e._v("isProxy: 检查一个对象是否是由 "),r("code",{pre:!0},[e._v("reactive")]),e._v(" 或者 "),r("code",{pre:!0},[e._v("readonly")]),e._v(" 方法创建的代理")])]),r("h1",[e._v("三、新的组件")]),r("h2",[e._v("1.Fragment")]),r("ul",[r("li",[e._v("在 Vue2 中: 组件必须有一个根标签")]),r("li",[e._v("在 Vue3 中: 组件可以没有根标签, 内部会将多个标签包含在一个 Fragment 虚拟元素中")]),r("li",[e._v("好处: 减少标签层级, 减小内存占用")])]),r("h2",[e._v("2.Teleport")]),r("ul",[r("li",[r("p",[e._v("什么是 Teleport（传送）？—— "),r("code",{pre:!0},[e._v("Teleport")]),e._v(" 是一种能够将我们的"),r("strong",{staticStyle:{color:"#DD5145"}},[e._v("组件 html 结构")]),e._v("移动到指定位置的技术。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<teleport to="移动位置">\n\t<div v-if="isShow" class="mask">\n\t\t<div class="dialog">\n\t\t\t<h3>我是一个弹窗</h3>\n\t\t\t<button @click="isShow = false">关闭弹窗</button>\n\t\t</div>\n\t</div>\n</teleport>\n')])])])]),r("h2",[e._v("3.Suspense")]),r("ul",[r("li",[r("p",[e._v("等待异步组件时渲染一些额外内容，让应用有更好的用户体验")])]),r("li",[r("p",[e._v("使用步骤：")]),r("ul",[r("li",[r("p",[e._v("异步引入组件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { defineAsyncComponent } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'vue'")]),e._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[e._v("Child")]),e._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[e._v("defineAsyncComponent")]),e._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("() =>")]),e._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[e._v("import")]),e._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./components/Child.vue'")]),e._v("))\n")])])]),r("li",[r("p",[e._v("使用"),r("code",{pre:!0},[e._v("Suspense")]),e._v("包裹组件，并配置好"),r("code",{pre:!0},[e._v("default")]),e._v(" 与 "),r("code",{pre:!0},[e._v("fallback")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<template>\n    <div class="app">\n        <h3>我是App组件</h3>\n        <Suspense>\n            <template v-slot:default>\n                <Child />\n            </template>\n            <template v-slot:fallback>\n                <h3>加载中.....</h3>\n            </template>\n        </Suspense>\n    </div>\n</template>\n')])])])])])]),r("h1",[e._v("四、其他")]),r("ul",[r("li",[r("p",[r("strong",{staticStyle:{color:"#DD5145"}},[e._v("移除")]),e._v("keyCode 作为 v-on 的修饰符，同时也不再支持"),r("code",{pre:!0},[e._v("config.keyCodes")])])]),r("li",[r("p",[r("strong",{staticStyle:{color:"#DD5145"}},[e._v("移除")]),r("code",{pre:!0},[e._v("v-on.native")]),e._v("修饰符")]),r("ul",[r("li",[r("p",[e._v("父组件中绑定事件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<my-component v-on:close="handleComponentEvent" v-on:click="handleNativeClickEvent" />\n')])])]),r("li",[r("p",[e._v("子组件中声明自定义事件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v("<script>\nexport default {\n    emits: ['close'],\n}\n<\/script>\n")])])])])]),r("li",[r("p",[r("a",{attrs:{href:"https://v3.cn.vuejs.org/guide/migration/array-refs.html#%E8%BF%81%E7%A7%BB%E7%AD%96%E7%95%A5"}},[e._v("v-for 中的 Ref 数组")])]),r("ul",[r("li",[r("p",[e._v("在 Vue 2 中，在 v-for 里使用的 ref attribute 会用 ref 数组填充相应的 $refs property，如下所示，会得到一个数组")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<div v-for="item in list" ref="itemRefs"></div>\n')])])]),r("li",[r("p",[e._v("在 Vue 3 中，这样的用法将不再在 $ref 中自动创建数组，需要使用更为灵活的方式")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<div v-for="item in list" :ref="setItemRef"></div>\n\nexport default { data() { return { itemRefs: [] } }, methods: { setItemRef(el) { if (el) { this.itemRefs.push(el) } } } }\n')])])])])]),r("li",[r("p",[r("a",{attrs:{href:"https://router.vuejs.org/zh/api/#router-link-%E7%9A%84-v-slot"}},[e._v("router-link 的 tag 属性问题")])]),r("ul",[r("li",[r("p",[e._v("在 vue-router4 中再使用 tag 属性的话会报警告，这是因为在 vue-routerv3.1.x 以上版本，新增 v-slot，推荐使用 custom、v-slot 代替 tag 属性，官方文档中的介绍是：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v("<router-link> 是否应该将其内容包裹在 <a> 元素中，在使用 v-slot 创建自定义 RouterLink 时很有用。\n默认情况下，<router-link> 会将其内容包裹在 <a> 元素中，即使使用 v-slot 也是如此，传递自定义的 prop，可以去除这种行为。\n")])])]),r("li",[r("p",[e._v("例如：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[e._v('<router-link to="/home" custom v-slot="{ navigate, href, route }">\n  <a :href="href" @click="navigate">{{ route.fullPath }}</a>\n</router-link>\n\n将会渲染成 <a href="/home">/home</a>\n\n<router-link to="/home" v-slot="{ route }">\n  <span>{{ route.fullPath }}</span>\n</router-link>\n\n渲染成 <a href="/home"><span>/home</span></a>\n\n参数：\n· href：解析后的 URL。将会作为一个 `<a>` 元素的 href 属性。如果什么都没提供，则它会包含 base。\n· href：解析后的 URL。将会作为一个 `<a>` 元素的 href 属性。如果什么都没提供，则它会包含 base。\n· route：解析后的规范化的地址。\n· navigate：触发导航的函数。 会在必要时自动阻止事件，和 router-link 一样。例如：ctrl 或者 cmd + 点击仍然会被 navigate 忽略。\n  也就是说，例如 <a :href="href" @click="navigate"></a> 这样的情况，href 会失效。\n· isActive：如果需要应用 active class，则为 true。允许应用一个任意的 class。\n· isExactActive：如果需要应用 exact active class，则为 true。允许应用一个任意的 class。\n')])])])]),r("p",[e._v("​")])])])])])])}],s=r(1001),v={},o=(0,s.Z)(v,l,n,!1,null,null,null),a=o.exports}}]);